# 엘라스틱 서치 기본 개념

Elasticsearch는 분산형 검색 엔진으로 데이터를 저장하고 빠르게 검색할 수 있는 시스템입니다.

## Cluster (클러스터)

Elasticsearch에서 클러스터는 하나 이상의 노드(Node)가 함께 작업하는 집합입니다.

**한 클러스터 안에 여러 노드가 존재할 수 있으며, 이들 노드가 데이터를 나누어 저장하고 효율적으로 검색을 처리합니다.**

## Node (노드)

Elasticsearch의 각 인스턴스를 '노드'라고 부릅니다. 노드는 데이터를 저장하고, 클러스터 내에서 인덱싱 및 검색 기능을 수행합니다.

### 노드 유형:

- **Master Node (마스터 노드)**: 클러스터 전체를 관리하고 조정하는 역할. 클러스터 상태 변경, 노드 추가/제거, 샤드 할당 등을 담당합니다.
- **Data Node (데이터 노드)**: 데이터를 저장하고 관련 CRUD 작업, 검색, 집계 등을 수행합니다.
- **Ingest Node (인제스트 노드)**: 데이터를 인덱싱하기 전에 사전 처리를 수행합니다. 데이터 변환, 필터링 등을 담당합니다.
- **Coordinating Node (코디네이팅 노드)**: 사용자 요청을 받아 적절한 노드로 라우팅하고 결과를 취합하는 역할을 합니다.

## Index (인덱스)

- **정의**: 인덱스는 문서를 조직하는 **논리적 네임스페이스**입니다. **관계형 데이터베이스의 테이블과 비슷한 역할을 합니다.** Elasticsearch에서는 데이터를 저장하고 검색하기 위해 인덱스를 사용합니다.
- **기능**: 문서를 저장하고, 검색하기 위한 단위로, 각 인덱스는 다양한 문서(Document)를 포함할 수 있습니다.

## Document (문서)

- **정의**: 문서는 Elasticsearch에서 저장되는 데이터의 기본 단위입니다. JSON 형식으로 데이터를 저장하며, 다양한 필드(field)를 가질 수 있습니다. 각 문서는 하나의 인덱스에 속하며, 그 안에서 검색되고 관리됩니다.
- **기능**: Elasticsearch에서 인덱싱하고 검색할 수 있는 정보의 기본 단위로, 각 문서에는 특정한 데이터를 담고 있습니다. 예를 들어, 사용자의 정보나 로그 데이터를 문서로 저장할 수 있습니다.

## Shard (샤드)

- **정의**: 하나의 인덱스는 더 작은 단위인 샤드(shard)로 나누어 저장될 수 있습니다. 샤드는 데이터를 분산시켜 저장하는 역할을 하며, Elasticsearch의 성능을 향상시키는 데 중요한 역할을 합니다.
- **기능**: 각 샤드는 인덱스의 일부 데이터만을 포함하며, 이를 통해 데이터를 여러 노드에 분산시켜 저장할 수 있습니다. 샤드는 두 가지 유형이 있습니다.
  - **Primary Shard (기본 샤드)**: 원본 데이터를 저장
  - **Replica Shard (복제 샤드)**: 기본 샤드의 복사본

## Replica (복제본)

- **정의**: 각 기본 샤드는 복제본(replica)을 가질 수 있습니다. 복제본은 기본 샤드의 복사본으로, 장애 발생 시 데이터의 안정성과 검색 성능을 높이는 역할을 합니다.
- **기능**: 복제본은 데이터의 가용성을 높이고, 검색 성능을 개선하는 데 도움을 줍니다. 복제본을 사용하면 읽기 작업이 분산되어 더 빠른 검색이 가능해집니다.

## Routing Table (라우팅 테이블)

- **정의**: 라우팅 테이블은 어떤 샤드가 어떤 노드에 저장되어 있는지에 대한 정보를 가지고 있습니다. 이 정보는 마스터 노드에 의해 업데이트되며, 코디네이팅 노드는 이를 참조하여 요청을 적절한 샤드로 라우팅합니다.
- **기능**: 클러스터 내에서 각 샤드가 어느 노드에 저장되어 있는지 파악하고, 요청이 해당 샤드로 정확하게 전달되도록 합니다.

## Gateway (게이트웨이)

- **정의**: 게이트웨이는 Elasticsearch 클러스터와 인덱스의 상태를 유지하는 메커니즘입니다. 클러스터가 재시작될 때 클러스터의 상태를 복원하는 역할을 합니다.
- **기능**: 클러스터의 상태를 영구적으로 저장하고, 장애 발생 시 이를 복구하는 역할을 합니다.

## Discovery Module (디스커버리 모듈)

- **정의**: 이 모듈은 새로운 노드가 클러스터에 원활하게 합류할 수 있도록 하며, 노드 상태의 변화를 관리합니다.
- **기능**: 새로운 노드가 기존 클러스터에 참여하거나, 기존 노드가 실패하는 상황을 처리하여 클러스터가 안정적으로 운영되도록 돕습니다.

![구조](https://file.notion.so/f/f/87d240b6-b6a0-4d94-b759-5a1349dc8070/561e3b2c-e074-4f99-918c-5291aa395e23/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-14_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.13.27.png?table=block&id=1d5d933d-39cc-8043-9442-d49df3208cfd&spaceId=87d240b6-b6a0-4d94-b759-5a1349dc8070&expirationTimestamp=1745416800000&signature=hTLr--EqyH1_P2rsI_Xhzwvjdi3LEE39WWGdGB_tQYI&downloadName=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2025-04-14+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+1.13.27.png)

# Elasticsearch의 구조: 도서관 비유

## 클러스터 = 도서관 전체 건물
클러스터는 도서관 전체 건물입니다. 모든 책과 정보가 이곳에 존재하며, 하나의 이름으로 관리됩니다.

## 노드 = 도서관의 각 층
각 노드는 도서관의 한 층이라고 볼 수 있습니다. 각 층에는 책장들이 있고, 서로 다른 역할을 맡을 수 있어요. 어떤 층은 신착 도서를 처리하고, 다른 층은 검색을 담당하는 식입니다.

## 인덱스 = 도서 분류 체계
도서관에서는 책을 주제별로 분류합니다. Elasticsearch에서 인덱스는 이런 분류 체계와 같아요. 예를 들어 "소설", "역사", "과학" 같은 큰 카테고리라고 생각하면 됩니다.

## 샤드 = 책장
각 주제(인덱스)의 책들은 너무 많아서 여러 책장에 나눠 보관합니다. 샤드는 이런 책장과 같습니다. 하나의 주제가 여러 책장에 분산되어 있으면, 여러 사람이 동시에 같은 주제의 책을 찾을 수 있어 효율적입니다.

## 레플리카 = 책의 복사본
중요한 책들은 여러 복사본을 만들어 다른 층(노드)의 책장에도 보관합니다. 한 층이 공사 중이거나 문제가 생겨도 다른 층에서 같은 책을 찾을 수 있죠. 이것이 레플리카입니다.

## 문서 = 개별 책
도서관의 각 책이 Elasticsearch의 문서입니다. 각 책은 제목, 저자, 출판일 등 다양한 정보를 담고 있죠.

## 필드 = 책의 속성
책의 제목, 저자, 출판일, 페이지 수 등이 필드에 해당합니다. 문서의 각 속성을 나타냅니다.

## 매핑 = 도서 카탈로그 규칙
도서관에서는 어떤 정보를 어떻게 분류하고 기록할지 규칙이 있습니다. 매핑은 이런 카탈로그 작성 규칙과 같아요. "저자명은 항상 성과 이름 순서로", "출판일은 연/월/일 형식으로" 같은 규칙들이죠.

## 쿼리 = 도서 검색
도서관에서 책을 찾을 때 검색 요청을 하는 것처럼, Elasticsearch에서는 쿼리를 통해 원하는 정보를 찾습니다.